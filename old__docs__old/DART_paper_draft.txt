DART:

Introduction:
Materials discovery has formed the cornerstone of technological innovation for millennia and is primed to be the solution to many challenging obstacles that humanity faces, from anthropogenic greenhouse gas emissions and renewable energy storage to advanced therapeutic development. Despite the pressing need for novel and advanced materials, discovery is slow and cumbersome. Experimental design and characterization of new materials in the lab is expensive and time consuming and the investigation of a single material can take months. In the last decades, this challenge has given rise to computational high-throughput screening algorithms using quantum chemistry calculations which reduce the time for investigation of a single material from months to hours. These methods have produced a whole ecosystem of large computational database platforms adhering to the FAIR standard of data sharing such as the Materials Project, the Open Catalyst Project, the Organic Materials Database and many others. In turn, these databases have propelled the development of powerful machine learning algorithms for state of the art materials screening leveraging quantum properties and reaction descriptors and resulted in an unprecedented number of discoveries of novel materials for X, X and X.

Nowadays, a special focus of research concerns the study of transition metal complexes, which feature a metal center bound to one or more mostly organic ligands. The freedom of combining a range of metal centers with multiple different ligands provides an extensive playing field for tuning transition metal complexes according to desired criteria, which makes them attractive candidates for a wide range of applications spanning therapeutics, catalysis, and photovoltaics9,10. This diversity is expressed in the Cambridge Structural Database (CSD) which contains structural information of around 200,000 monometallic complexes made up of more than 67,000 different ligands.

Although vast, this top-down database has inherent limitations. The chemical space of complexes in the CSD is limited by trends in chemical discovery over the past number of decades and by the requirement that all structures in the CSD must be able to be crystallized. Even taking into account only octahedral complexes and only the 67,000 different ligands already present in the CSD, the molecular complexes contained in the CSD nowadays make up less than 0.000000000002 percent of the number of complexes that are combinatorically possible, while the rest is currently unexplored by humanity.
To challenge the traditional discovery way of discovering molecules, the in-silico bottom-up assembly of transition metal complexes from a set of input ligands recently has attracted major attention27,17,28–37. Databases of ligands21–26,38 were developed such as the tmQMg-L37 and the ReaLigands39 database with around 30,000 entries, which are based on the tmQM14 and the tmQMg15. Other groups have developed comprehensive assembly algorithms for the construction of complexes from input ligands such as MolSimplify, which has found application in the generation of new candidates for chromophores and catalysts,16,40 or stk, a general framework supporting the assembly of multiple classes of molecules which has seen a wide range of applications.16,41–43

Despite multiple assembly algorithms and ligand databases, we see little use of these resources in the daily life of a researcher interested in organometallic complexes, which we attribute to the difficulty in using these scattered resources in concert. In view of the major interest in investigating novel molecular complexes with attractive properties, there is a need for a user-friendly and large-scale exploration and assembly platform for mono-metallic transition metal complexes. Importantly, to allow a researcher to target the assembly towards types of complexes they are interested in, this platform needs advanced filtering options to focus on ligands of interest and to direct the assembly towards user-desired chemical spaces.

To this end we introduce a novel workflow involving the rapid assembly of complexes of interest for targeted chemical spaces. To enable this workflow we present DART (Directed Assembly of Random Transition metal complexes), an open-source platform developed in Python to facilitate the automated and directed assembly of novel molecular complexes controlled by input instructions via simple text files shown in Fig. 1. To fuel the assembler unit, DART provides a ready-to-use database of 41,018 ligands extracted from experimentally verified mono-metallic complexes from the entire CSD with automatically assigned reliable formal charges. This large database of ligands enables DART in its current version to assemble ca. 500 billion different molecular complexes for each transition metal. To direct DART towards user-desired types of complexes, the assembler unit comes with a broad range of instructions and filters to control the assembled complex geometries and the selected ligand space. The tight integration of ligand database and assembler unit makes DART a powerful tool and allows it to include advanced features unique for DART, such as controlling that complexes are assembled only from ligands which have been seen bonding to the corresponding metal center before. These features make DART capable to generate novel complexes with high synthetic viability and for very targeted types of complexes. Importantly, DART was not developed to replace a chemist, but rather to give them a powerful new tool to explore in their daily research. In the following sections, we describe the workflow of developing DART and how to use it, from the extraction of ligands and the charge assignment to the assembly of novel complexes and their input files for quantum mechanical calculations. To demonstrate the potential of DART, we conclude with a simple example of a high throughput screening of square planar palladium complexes for cross-coupling, highlighting how we envisage DART may be used by the scientific community.

Ligand Extraction and Charge Assignment:
To enable a straightforward assembly of novel metal complexes for any DART user, the first step in this work was the creation of a ready-to-use ligand database extracted from mono-metallic complexes from the CSD with automatically assigned formal charges, which we refer to as MetaLig, the organoMETAllic LIGand database. In order to extract the ligands, we obtained the 3D geometries of all CSD entries containing exactly one d- or f-block metal with specified metal oxidation state, total charge and molecular graph. This set of mono-metallic complexes was further refined by identifying potentially erroneous geometries such as molecules with unresolved hydrogens as described in detail in the Supporting Information. After curation we are left with a dataset of 107,185 mono-metallic complexes which is the source for all ligands in the MetaLig and will be referred to in this publication as CSDMM.
For the ligand extraction and charge computation, we make use of the molecular graph of each complex as provided by the CSD, specifying which atoms are bound to which other atoms. Importantly, DART does not require information about bond orders, only the connectivity. After removing the metal center from the graph, the unconnected graph fragments are identified as ligands. Since many ligands repeat frequently across multiple complexes, each ligand receives a unique name which is consistent across all occurrences of this ligand in the CSDMM. Two ligand instances are defined to be the same ligand if they have the same coordinating atoms and the same molecular graph as determined by the Weisfeiler Lehman hash30,31. Solvent molecules and counter ions in the provided input geometries are allowed and treated as ligands with denticity of 0.
After all ligands are extracted, the formal charges of all ligands are automatically computed using a self-consistent combinatorial algorithm we refer to as Linear Charge Solver, inspired by previous work by Duan et al.32 It requires only the total charge and metal oxidation state of each complex plus the unique names of its ligands. Notably, no information about the ligand properties is required.
The Linear Charge Solver is based on the realization that ligand charges are implicitly contained within the CSDMM, because knowing the total charge and metal oxidation state of a complex determines the sum of charges of all of its ligands. Since many ligands repeat frequently across many complexes, and assuming that identical ligands have the same charge, it is possible to set up this combinatorial problem as a system of linear equations and solve for the ligand charges. However, owing to the presence of occasional errors and inconsistencies in the CSDMM it is not possible to perfectly solve for the ligand charges using conventional algorithms. Therefore, an error minimization algorithm via gradient descent is used to approximately solve the system of linear equations and return the approximated ligand charges. Finally, the Linear Charge Solver calculates a confidence score on each computed charge by employing multiple methods based on self-consistency. Details on the implementation of the algorithm can be found in the Supporting Information.
There are multiple types of inconsistencies that can cause a ligand to be flagged as not confident. In general, the term inconsistent means that the same ligand appears to not always have the same charge in all complexes across the CSDMM. This can be caused by database errors such as incorrectly assigned metal oxidation states and total charges or incorrect molecular graphs. It can also be caused by charge-non-innocent ligands with multiple resonance forms for the same ligand. Finally, ligands are automatically flagged as not confident if after charge assignment the ligand is open-shell, since this turned out to frequently indicate an issue, while actual open-shell ligands are rare. Ligands are also automatically flagged as not confident if the predicted charge is smaller than -4 or higher than +1.
Out of the 45,463 extracted unique ligands, the Linear Charge Solver confidently computes the formal charge for 41,018 (90.22%) ligands. These 41,018 ligands are saved and form the MetaLig database. To assess the quality of the calculated ligand charges we used a benchmark dataset of 330 randomly chosen ligands from the CSDMM with manually assigned formal charges. Out of the 330 charges, the Linear Charge Solver is confident in 319 charges and not confident in 11 charges. Comparing the computed charges with the manually assigned charges yields an accuracy of 100% on the confident and 55% on the not confident charges. This benchmark demonstrates that the Linear Charge Solver computes highly accurate ligand charges and reliably flags ligands for which it has difficulties to compute the charge. More details on the charge benchmark can be found in the Supporting Information.

Ligand Database Properties and Targeted Ligand Filtering:
The MetaLig database with 41,018 ligands is packaged within the DART program and is the source of all ligands for the assembly of novel complexes. It encompasses a diverse chemical space which allows for the generation of an equally diverse range of mono-metallic complexes. An overview of the number of ligands with a particular set of coordinating atoms is given in Fig. 2b, showing for example ca. 8,000 bidentate N-N donors.
Before the assembly, the MetaLig database can be filtered down to create more refined ligand datasets tailored to each use case (Fig. 3a). This allows users to assemble complexes that target specific regions of chemical space, where each ligand site is populated with ligands from a different ligand dataset. The ligand filter module of DART is controlled via a simple input text file and contains a variety of already implemented filters targeting intrinsic attributes of ligands such as empirical formula, denticity, formal charge, ligand composition, donating atoms and molecular weight (Fig. 3b). A list of all currently implemented filters can be found in the Supporting Information.
A difficult challenge in assembling novel metal complexes is to maximize their synthetic viability. For generating synthetically viable Pd complexes for example, it can be helpful to filter out ligands which have never been seen coordinating to Pd before. The ligand filter module includes a filter which makes this possible. It makes use of extrinsic ligand attributes in the MetaLig, which contain a statistical profile of the ligand across all of its occurrences in the CSDMM, such as a list of the metal centers and the CSD IDs of all complexes it was found in. An overview of the number of ligands with precedent to a certain metal center is given in Fig. 2a, showing nearly 8,000 ligands with precedent binding to Pd.

Assembly:
The generation of novel TMCs is guided by a set of user-provided instructions, contained within a simple input file. Within this file, the user specifies the total molecular charge, the metal center type, oxidation state, spin-multiplicity, and the general topology of the TMCs they wish to assemble. The topology specifies the arrangement of ligands of a specific denticity surrounding a metal center. For example, Fig. 4a shows a metal center coordinated by a bidentate and two monodentate ligands denoted as (2,1,1), with the integers referring to the denticities of the topology’s respective ligands. To allow for greater control of the specific properties expressed by each individual ligand, the user can attribute each ligand site with a unique ligand database. For example, for the (2,2) topology (Fig. 4a), the user can install N-N coordinating ligands at one bidentate ligand site with the other occupied by varying P-P coordinating ligands. Conversely, a user can enforce chemical equivalence of ligands across multiple ligand sites. Geometric isomerization in the context of ligand binding mode is also handled by DART. Users can select whether to generate all geometric isomers or only the lowest energy isomer as determined by the relative energies obtained from a UFF calculation.44 With the user options specified, DART assembles complexes using a series of rotation and placement algorithms that chooses the optimum positioning of ligands based on their denticities. Supported denticities currently range from monodentate to pentadentate as shown in Fig. 4b. A detailed description of these algorithms can be found in the supporting information. Finally, assembled TMCs (Fig. 4c) are subject to a series of geometry checks to remove structurally invalid complexes. If successful, the assembled complex is saved as an xyz file together with accompanying information regarding its constituent ligands. In addition, each assembled complex is attributed with all CSD codes of entries that contain each assembled complex’s constituent ligands. These CSD codes can be used to retrieve the pertinent academic publication relating to each of the constituent ligands, facilitating synthesis.

Example (work in progress):
Greater incorporation of in-silico high through-put screening promises not only to expedite but also streamline the materials discovery process. Methods that facilitate the generation of large-scale molecular databases with an emphasis on speed, user-accessibility and robustness are required to make this paradigm shift. To demonstrate DART’s competencies in these key aspects of molecular database generation we explore the ubiquitous TMC catalyzed cross coupling reaction shown in Fig. 5a.45–47
(I have referenced Suzuki, Heck and Sonogashira. May need to reference more?) Widely used as a primary method for C-C bond formation, major advances in pharmaceutical development, natural product synthesis and the fine chemicals industry can be attributed to TMC catalyzed cross couplings.48,49 Typically, a Pd metal center serves as the catalytic site owing to its high activity. However, recent efforts have sought to replace Pd with earth abundant Ni in the interest of cost and sustainability.50 Synergistic effects between ancillary ligands and the metal center can serve to enhance or hinder cross coupling. Thus, careful consideration must be paid to the choice of ligands. In recent years, development, and incorporation of P-N-type ligands as spectator ligands in TMC catalyzed cross coupling has gained momentum.51 The relatively soft, π-acceptor character of the P atom helps to stabilize a low valent metal center whereas the hard, σ-donor N atom can stabilize the high valent oxidative addition intermediate, an important intermediate in TMC catalyzed cross coupling.51 With these key considerations in mind we have generated an exemplar database of 620 Pd(II) and Ni(II) TMCs that explores the effects of modifying the P-N donor type ligand. Three ligand data sets were obtained from the MetaLig database using a simple input file (Fig. 5d) to direct the filtering process. The first two data sets contained single entries of a Bromide and phenyl group respectively. The third database was filtered from the MetaLig database to target neutral P-N donor type ligands (Fig. 5b). 173 ligands were extracted, all of which have precedents binding to Pd or Ni on the CSD.  Each of the 173 P-N type ligands can exhibit cis or trans isomerism relative to the bromide and phenyl ligands. Within the assembly input file (Fig. 5d) the “Generate All” isomers option was selected.  This results in 346 possible complexes per metal center type. However, due to the steric constraints in the context of the bromide and phenyl monodentate ligands, not all P-N type ligands will be compatible. Some structures will fail the post-assembly geometry checks if the P-N type ligand overlaps with either of the monodentate ligands. In total 314 Pd(II) and 306 Ni(II) structures were generated. Generation of all the unique structures takes on the order or minutes and can be completed on a standard laptop. To demonstrate the breadth of chemical space that can be explored with DART, we have optimized each of the 620 structures using DFT at the rwb97xd level of theory, expressing each complex in terms of their chemically relevant properties (Fig. 5e-g). By considering the M-P and M-N bond lengths we can demonstrate the innate π-acceptor, σ-donor character of P, N type ligands. Increased negative charge on the metal center (blue) increases the back donation from the metal to the P π-acceptor orbitals, decreasing the M-P bond length. Conversely, a lengthening of the M-N bond distance is observed with the increased M negative partial charge inhibiting electron donation from N. These bonding characteristics are observed for both the Pd and Ni metal centers. The HOMO-LUMO gap of a molecule can be an important descriptor of its reactivity. Fig. 4f demonstrates the frequency of the HOMO-LUMO gap within the Pd/Ni datasets.  A slight skew of HOMO-LUMO gap for the Pd complexes can be attributed to the relatively lower energy HOMOs compared to Nickel. The larger effective nuclear charge of Pd stabilize these HOMO orbitals.1,2 Pertinent to TM catalyzed cross coupling, the natural bite-angle or chelation angle can alter not only the steric but also the electronic properties of a complex. Screening of candidate complexes based on their natural bite-angle can facilitate tuning of reactivity.3
Fig. 5g denotes the distribution of bite-angles among Pd/Ni complexes. The trimodal nature of this distribution is a direct result of the size of the metallacycle (Fig.5g). For example, the right most peak predominantly describes the distribution of natural bite-angles for 5-membered metallacycles (Fig. 5g(iii)). Variations of ligand structure and the presence of hetero atoms within the ring system results in a broad distribution. Due to the low occurrence of 7-membered metallacycles (Fig. 7g(iv)) within the dataset they are subsumed within the third right-most peak. Fig.5 serves to underscore DART’s capabilities in the generation of targeted molecular databases. Attributes such as structural properties, HOMO-LUMO gap and natural bite angle among others can be used to refine molecular databases and obtain a selection of candidate molecules tailored for a specific chemical role, in turn expediting molecular design and discovery.

Expectations and scope of DART:
DART was developed based on a set of fundamental assumptions which influenced many design decisions. Most notably, it was decided to not rely on correct bond orders but only molecular connectivity to make DART more general and invariant to common difficulties in assigning bond orders for transition metal complexes, which significantly increases the variety of extracted ligands. As a consequence of the focus on connectivity, DART does not recognize the inherent chemical inequivalence between ligands that have a stereoisomeric relationship. For representing the unique ligand, one 3D structure will be randomly chosen. It is also important to recognize that the MetaLig is generated using the CSD, a professionally curated database which nevertheless contains sporadically occurring errors. Poorly resolved crystallographic disorder within certain entries can lead to overlapping chemical structures and missing or surplus hydrogens. We have taken every effort to try to automatically detect and remove these errors as described in the Supporting Information, but it is possible that a small number of these structural anomalies are present in the MetaLig. Finally, any user should also be aware of the inherent difficulties in predicting chemical validity for complexes assembled in high-throughput, in-silico assembly programs. DART assembles chemically plausible structures but there is no guarantee of experimental synthetic viability. Rational choice of ligand motifs, metal centers and topologies will greatly increase the likelihood of a molecule be synthesized. While DART is a powerful new tool for researchers to screen novel mono-metallic complexes, it will never replace a skilled chemist in the final evaluation of an assembled complex.
